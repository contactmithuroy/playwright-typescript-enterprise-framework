# Parabank Playwright Framework

Fully automatic, data-driven Playwright framework with CSV control, registry-based tests, and step-level reporting. This project targets the Parabank demo site.

## What This Framework Does
- Data-driven execution via CSV
- Automatic step tracking for all page object methods
- Inline screenshots attached to Playwright steps
- Registry pattern (no switch/case)
- Centralized hooks and fixtures

## Project Structure
```
.
|-- data-models/
|   `-- dataStore.ts                # Central CSV data access
|-- pages/
|   |-- Common/
|   |   |-- base.page.ts            # Base page helpers
|   |   |-- LoginLogout.page.ts     # Login/Logout for Parabank
|   |   `-- MainNavigationPage.ts   # Menu navigation
|   `-- MainPages/
|       `-- MakeATransfer.page.ts   # Transfer Funds page
|-- test-data/
|   |-- Smoke_TestCases.csv         # Test control (Y/N/NA/NE)
|   `-- MakeATransferData.csv       # Transfer Funds data
|-- tests/
|   |-- base-hooks.ts               # Fixtures + global page objects
|   |-- hooks/
|   |   `-- TestHooks.ts            # Lifecycle + auto step tracking
|   |-- registry/
|   |   `-- TestRegistry_Auto.ts    # Test registry map
|   `-- smoke/
|       `-- DynamicSmokeTestsAuto.spec.ts  # Data-driven runner
|-- utils/
|   |-- CommonFunctions.ts          # Env + helpers
|   |-- csvReader.ts                # CSV reader
|   `-- SmokeTestController.ts      # CSV test selection
|-- playwright.config.ts            # Playwright config
|-- .env                            # URL + credentials
`-- README.md
```

## How It Works (Interaction Flow)
1. Test spec loads:
   - `tests/smoke/DynamicSmokeTestsAuto.spec.ts`
   - Reads `test-data/Smoke_TestCases.csv` via `SmokeTestController`
2. Fixtures initialize:
   - `tests/base-hooks.ts` creates page objects and exposes them globally
3. Hooks initialize:
   - `tests/hooks/TestHooks.ts` wraps every page object method with auto `test.step(...)`
4. Registry executes:
   - `tests/registry/TestRegistry_Auto.ts` executes the named test function
5. Data access:
   - `data-models/dataStore.ts` loads test data CSVs
6. Reporting:
   - Screenshots attached inline to steps
   - HTML/JUnit reports generated by Playwright

## Environment Variables
Set in `.env`:
```
BASE_URL=https://parabank.parasoft.com/
PARABANK_USER=john
PARABANK_PASS=demo
TAKE_SCREENSHOTS=true
```

## Setup
1. Install dependencies
```
npm install
```

2. Install Playwright browsers (first time)
```
npx playwright install
```

## Run Tests
Run full smoke suite:
```
npx playwright test tests/smoke/DynamicSmokeTestsAuto.spec.ts
```

Run specific test:
```
npx playwright test tests/smoke/DynamicSmokeTestsAuto.spec.ts --grep "Verify_Transfer_Funds"
```

## Reports
HTML report:
- Output folder: `AllTestResults/HTMLReports`

JUnit report:
- File: `AllTestResults/junit-results.xml`

Open HTML report:
```
npx playwright show-report AllTestResults/HTMLReports
```

## CSV Control (Smoke_TestCases.csv)
```
run,testCaseId,testTag,requiresLogin,testFunction,testData
Y,Verify_Transfer_Funds,@smoke,true,Verify_Transfer_Funds,MakeATransferData.csv
```

- `run` values: `Y`, `N`, `NA`, `NE`
- `testFunction` must match a registry key in `TestRegistry_Auto.ts`

## DataStore Alignment
`data-models/dataStore.ts` maps CSV filenames to keys:
- `MakeATransferData` -> `test-data/MakeATransferData.csv`

Registry tests load these keys:
```ts
DataStore.getRow('MakeATransferData', 0)
```

## Add a New Test (Quick Steps)
1. Add page object methods in `pages/`
2. Register a test in `tests/registry/TestRegistry_Auto.ts`
3. Add CSV data in `test-data/`
4. Add a row to `test-data/Smoke_TestCases.csv`

## Notes
- Account IDs on Parabank are dynamic. CSV supports `first`/`second` to select accounts by index.
- `TestHooks` uses `BASE_URL` from `.env` for navigation.
